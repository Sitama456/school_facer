### 双缓冲日志系统设计目标
1. 功能需求
   - 有多种日志级别。比如TRACE DEBUG INFO ERROR FATAL
   - 日志可以有多个去向。比如文件、socket。
   - 日志消息格式可以配置
   - 日志可以配置过滤器。
项目只对第一条功能做了配置，其余功能都是在代码中写死了。

### 项目的日志系统结构。
1. 日志消息，描述了一条日志的产生时间、产生的文件、日志级别和日志内容等重要消息。
2. 前台线程调用相应的宏，产生一条日志消息。并且定义一个全局的写操作函数指针和刷新操作函数指针。通过这两个函数指针可以控制消息的去向。如果是标准输出，那么就是同步日志方式，直接输出到屏幕上。如果调用后台线程的输入函数，就是异步日志。
3. 后台线程中维护一个数组，数组中是大小为4MB的缓冲区(可以配置)。后台线程的主函数就是一直将缓冲数组中缓存的日志消息刷新到磁盘上。它平常时会阻塞在一个条件变量上，醒来的条件是缓冲数组不为空或者3秒间隔到了。
4. 写日志过程: 前台线程产生一条日志消息，将此日志消息写入到后台线程预备的一个缓冲区中。后台线程先预备了两块缓冲区，一块写，一块预备。如果写缓冲区满了，就交换，然后将满了的缓冲区推入到缓冲区数组中，后台线程就被唤醒了。后台线程处理完写日志后，又准备两块缓冲区，一直循环。