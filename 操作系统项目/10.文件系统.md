### 什么是文件系统？
1. 文件系统是操作系统中负责持久数据保存的子系统，提供数据存储和访问的功能。例如数据组织、检索和访问。
2. 文件时具有符号名、字节序列构成的数据项集合，是文件系统的基本数据单位。对操作系统而言，不关心文件内部的结构。对用户而言，文件时一个持久的数据结构。对系统而言，文件是一系列数据块的集合。
3. 进程访问文件数据的方式和组织文件的方式不一定相同。对于进程访问数据，可以有顺序访问(大多数)、随机访问(不常用，如虚拟内存)、索引访问。

### 虚拟文件系统是什么？
1. 虚拟文件系统时Linux文件系统中比较典型的概念。它抽象了各种文件系统的特征，提供了一系列数据结构和方法，对上，提供统一的文件系统访问接口；对下，和不同的文件系统相对接。
2. VFS隐含的主要思想在于引入一个通用的文件模型，这个模型能够表示所有支持的文件系统。内核不能对一个特定的函数进行硬编码来指向诸如read()或write()这样的操作，而是对于每个操作都必须有一个函数指针，指向要访问的具体文件系统的适当函数。

### 虚拟文件系统由什么组成？
1. 超级块对象。每个VFS对象都存放一个适当的数据结构中，其中包括对象的属性和指向对象方法表的指针，内核可以动态地修改对象的方法，可以为对象建立专用的行为。超级块对象保存的是设备标识、块大小、最大文件长度、文件系统类型、方法表指针、魔术、根目录的目录项、引用计数、有关的信号量。
2. 索引节点对象。当访问文件时，内存中会创建索引节点对象。内存中创建的索引节点对象，包含了磁盘上的索引节点，信息更加丰富，作用更复杂。
3. 文件对象。描述进程怎样与一个打开的文件进行交互，文件对象是在文件被打开时创建的，由内核中定义分file结构体描述。文件对象在磁盘上没有对应的映像，因此没有脏位。
4. 目录项对象。磁盘目录项被读入内存时，VFS就把它转换成基于dentry结构的一个目录项对象。保存与文件名关联的索引节点、引用计数器、父目录、文件列表、子目录等。

### 简单文件系统由什么组成？
1. 文件描述符，是操作系统在打开文件表中维护的打开文件的状态和信息。操作系统为每个进程维护一张打开文件表(此外还有一个系统级的打开文件表)，其中的每个元素是文件描述符，主要包括：文件指针、文件打开计数、文件磁盘位置与缓冲、访问权限等。
2. 文件控制块superblock。也叫超级块，是文件系统的最顶级单元，每个文件系统一个，记录了磁盘的详细信息，比如块大小，块计数，空闲块，指针等。超级块在文件系统挂载到VFS时被读入。
3. 文件控制块inode/vnode。即通常的索引节点，每个文件一个(目录也是文件)记录文件的详细信息及各类属性，如权限、拥有者、大小、数据块位置、时间属性等。
4. 目录节点dentry。每个目录一个，其中的条目即目录项，记录文件名和文件控制号，以指向文件或目录、子目录。在遍历一个文件路径，访问到该文件目录时，该文件节点被读入到内存中。

### 简单文件系统中如何存取文件
1. 根据文件名，通过目录项，找到相应的inode节点。
2. 根据inode节点编号，从文件中读取inode。
3. 再根据inode，读取相应的blocks。

### 项目中的VFS和SFS怎么初始化的？
1. VFS初始化设备链表vdev_list。该链表中链接的是虚拟设备vfs_dev_t结构体对象，此结构体中的主要成员就是设备名字、挂载节点inode和文件系统fs结构体成员。
2. 设备初始化，主要初始化三个设备，stdin, stdout,和disk0。设备初始化比较简单，创建一个inode结构体对象，该结构体中有一个device结构体成员变量。divice结构体中主要记录了块个数、块大小和一些列诸如打开、关闭、IO操作的函数指针。只需要将该inode中的device对象中的信息初始化，将相关函数指针指向设备的对应函数即可，然后用该inode和sfs创建一个虚拟设备对象加入设备链表中。
3. 简单文件系统的初始化。该初始化就是将SFS挂载到VFS的设备链表中。由于SFS是在disk0磁盘设备上的，所以挂载时传入disk0磁盘名字，VFS根据名字在设备链表vdev_list中找到对应的对象。找到对象之后，调用SFS的挂载回调函数，完成挂载操作。
4. SFS的挂载回调函数中，会做一些检查。然后读入超级块并保存到文件系统fs结构体中，开始初始化fs对象。最后初始化并挂载完成。


### 从进程到访问文件的过程

