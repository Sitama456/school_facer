### 什么是虚拟存储？
1. 虚拟存储是一种空分复用的技术，它将物理内存抽象为地址空间，每个进程都有各自的地址空间，地址空间的页被映射到物理内存，地址空间的页并不需要全部在物理内存中，当使用一个没在物理内存的页时，触发缺页中断，执行页面置换算法，将该页置换到物理内存中。
2. 将不常用的部分内存块暂存到外存中。装在程序时，只将当前执行需要的部分页面或段装入内存。将内存中暂时不用分页面保存到外存中。

### 虚拟内存的目的是什么？
为了让物理内存扩充成更大的逻辑内存，从而让程序获得更多的可用内存。

### 有哪些页面置换算法？
1. 最佳置换算法。每次选择淘汰的页面将是以后永不使用的，或者在最长时间内不在访问的页面，这样保证最低的缺页率，但实际上，只有在进程执行的过程中才能知道接下来会访问到的是哪个页面。操作系统无法提前预判页面访问序列。因此，最佳置换算法是无法实现的，只是一种评判置换算法好坏的标准。
2. 先进先出置换算法(FIFO)。每次选择淘汰的页面是最早进入内存的页面。实现方法：将内存中的页根据调入的先后顺序组织成一个链表，需要换出时选取链表头部的页置换出去，并且修改对应的页表项。换入时则将换入的页插入到链表尾部。Belady现象:当为进程分配的物理页框数增大时，缺页次数不减反增。FIFO算法会出现Belady异常，原因时该算法与进程实际运行的规律不适应，即可能每次都换出下一次将访问到的页。因此算法性能差，但实现简单。
3. 最近最久为使用置换算法(LRU)。每次淘汰的页面时最进最久未使用的页面。实现方法: 赋予每个页面对应页表项中，用访问字段记录该页面自上次访问以来所经历的时间t(该算法需要专门的硬件支持，虽然算法性能好，但是实现困难，开销大)。当需要淘汰一个页面时，选择现有页面中t值最大的，即最近最久未使用的页面置换出去。
4. 时钟置换算法(CLOCK)。是一种性能和开销比较均衡的算法，又成为CLOCK算法，或最近未使用算法。简单的CLOCK算法实现方法：为每个页面设置一个访问位，在将内存中的页面都通过链接指针链接成一个循环队列。当某页被访问时，其访问位置为1.当需要淘汰一个页面时，只需要检查页的访问位。如果是0，就选择该页换出，如果是1，就将它置为0，暂不换出，继续检查下一个页面。若某一轮的页面全是1，则将这些页面依次置为0。下一轮扫描一定能够选择换出页面。
5. 改进型时钟置换算法。简单的时钟置换算法仅考虑到一个页面最近是否被访问过。事实上，如果被淘汰的页没有被修改过，就不需要写回到外村中。因此，除了考虑一个页面最近有没有被访问过之外，操作系统还应该考虑页面有没有被修改过。在其他条件都相同时，应优先淘汰没有修改过的页面，避免磁盘IO操作。实现方法：增加一个修改标志脏位，为0没有修改，为1，修改了。用(A, M)表示页的访问和修改状态。
淘汰规则：将所有可能被置换的页面排成一个循环队列。第一轮：从当前位置开始扫描到第一个(0,0)的页帧用于替换。本轮扫描不修改任何标志位(第一优先级，最近没访问且没有修改二点页)。第二轮：若第一轮扫描失败，则重新扫面，查找第一个(0,1)的帧用于替换。本轮扫描将所有的帧的访问位设位0(第二优先级 最近没访问但修改了的页)。第三轮，若第二轮扫描失败，则重新扫描，查找第一个(0, 0)的帧用于替换，本轮扫描不修改任何标志位。(第三优先级，最近访问过，但没修改的页)。第四轮：若第三轮失败，则查找第一个(0,1)的页用于替换(最近访问过，且修改过的页)。

### 局部性原理是什么
时间局部性： 一条指令的一次执行和下次执行，一个数据的一次访问和下次访问都集中在一个较短期间内。
空间局部性：当前指令和临近的几条指令，当前访问的数据和临近的几个数据都集中在一个较小区域内。
分支局部性：一条跳转指令的两次执行，很可能跳到相同的内存位置。

### 项目中的交换机制是怎么实现的？
1. 交换机制的初始化。主要初始化交换区swapfs。swapfs被建立在一个单独的IDE磁盘设备上。交换区的文件系统非常简单，就是把所有磁盘扇区划分成页(没8个扇区看成一页)。随着进程的推进，需要建立一些页面到swapfs的映射，方法就是把页写入swapfs前，在页表项中记录相应页在swapfs中的位置。使用swapfs页索引到swapfs中寻找页，这个索引被保存在页表项的8~31位中，共24位。
2. 页面置换其初始化。使用的是FIFO置换算法。项目的置换策略是消极置换，即只有当内存分配失败时才会置换不常用的页面。
3. 缺页异常处理。当产生缺页异常时，CR2寄存器保存了引发缺页异常的线性地址addr，执行流转到缺页异常处理例程中。首先在进程的线性区中查addr，找到即合法。接下来检查错误码，取其低2位分析缺页原因。分别表示读/写异常 物理页存在与否。然后检查其页表项，若是页表项不存在，则分配一个物理页帧；若是页表项不为0，则说明在外村swapfs中，分配一个物理页从外村中读入并修改相应的页表项。